recap_movie=function(U1,U2,U3,U4,data.movies,data.users)
{
  U=rbind(U1,U2,U3,U4)
  nb.movies = dim(data.movies)[1]
  
  
  rating.per.movie= as.data.frame(matrix(0, nrow = nb.movies, ncol = 7) )
  colnames(RatingPerMovie) = c("movieID","nbRating","avgRating","SdRating", "MaxRating","MinRating","MedRating")
  # matrice comprenant l'ID du film 
  #                    le nombre d'utilisateurs ayant noté le film
  #                    la moyenne des notes
  #                    l'écart-type des notes
  #                    la note maximale 
  #                    la note maximale 
  #                    la mediane des notes
  
  
  ## Nombre d'hommes et de femmes ayant vu un film donné (ainsi que la moyenne des notes attribuées)
  
  rating.per.movie.per.gender =as.data.frame( matrix(0, nrow = nb.movies, ncol = 5) )#matrice comprenant l'ID du film 
  colnames( rating.per.movie.per.gender) = c("movieID", "nbMen","avgRatingMen","nbWomen","avgRatingWomen")
  # mean.women=matrix(0, nrow = nb.movies, ncol = 2) 
  
  for (movie in 1:nb.movies)
  { 
    cond1=U$movieID == movie
    x=U$rating[cond1]
    rating.per.movie[movie,] = c(movie,length(x),round(mean(x),2),round(sd(x),2),max(x),min(x),median(x))
    
    cond2=(data.users$gender[U$userID]=="M")
    x=U$rating[cond1&cond2]
    y=U$rating[cond1&!(cond2)]
    rating.per.movie.per.gender[movie,] = c(movie,length(x),round(mean(x),2),length(y),round(mean(y),2))
    #mean.women[movie,]=c(movie,(mean(U$movieID == movie)-mean(x)*(length(x)/(length(x)+length(y))))*((length(x)+length(y))/length(y)))
    # on verifie que moyeWomen[i,2]=RatingPerMOviePerGender$avrRatingWomen[i] pour tout i
  }
  rm(x,y,movie,cond1,cond2)
  
  
  recap.movie = cbind(rating.per.movie,rating.per.movie.per.gender)
  rm(rating.per.movie,rating.per.movie.per.gender)
  return(recap.movie)
}
Enter file contents here
