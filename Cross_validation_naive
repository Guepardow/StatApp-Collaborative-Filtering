# = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
#       Fichier : Erreurs_prediction_naive.R
#       Description : 
# = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

# ===================================== 1.Création de la matrice de validation croisée ===============================================

cross_validation = matrix(0,3,5)
colnames(cross_validation) = c("random","meanOfUsers","meanOfMovies","meanByUser","meanByMovie")
rownames(cross_validation) = c("MSE","MAE","01")

# ===================================== 2.Using random ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
RMSE1 = error_function(naive_prediction1$rating,naive_prediction1$random,'RMSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAE')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$random,'01')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
RMSE2 = error_function(naive_prediction1$rating,naive_prediction1$random,'RMSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAE')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$random,'01')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
RMSE3 = error_function(naive_prediction1$rating,naive_prediction1$random,'RMSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAE')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$random,'01')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
RMSE4 = error_function(naive_prediction1$rating,naive_prediction1$random,'RMSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAE')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$random,'01')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
RMSE5 = error_function(naive_prediction1$rating,naive_prediction1$random,'RMSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAE')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$random,'01')

cross_validation[1,1] = mean(RMSE1,RMSE2,RMSE3,RMSE4,RMSE5)
cross_validation[2,1] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,1] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)

# ===================================== 3.Using MeanOfUsers ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
RMSE1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'RMSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAE')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'01')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
RMSE2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'RMSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAE')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'01')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
RMSE3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'RMSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAE')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'01')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
RMSE4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'RMSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAE')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'01')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
RMSE5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'RMSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAE')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'01')

cross_validation[1,2] = mean(RMSE1,RMSE2,RMSE3,RMSE4,RMSE5)
cross_validation[2,2] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,2] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)


# ===================================== 4.Using Mean of movies ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
RMSE1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'RMSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAE')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'01')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
RMSE2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'RMSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAE')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'01')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
RMSE3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'RMSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAE')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'01')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
RMSE4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'RMSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAE')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'01')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
RMSE5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'RMSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAE')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'01')

cross_validation[1,3] = mean(RMSE1,RMSE2,RMSE3,RMSE4,RMSE5)
cross_validation[2,3] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,3] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)

# ===================================== 5.Using mean by user ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
RMSE1 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'RMSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAE')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'01')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
RMSE2 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'RMSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAE')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'01')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
RMSE3 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'RMSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAE')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'01')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
RMSE4 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'RMSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAE')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'01')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
RMSE5 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'RMSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAE')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'01')

cross_validation[1,4] = mean(RMSE1,RMSE2,RMSE3,RMSE4,RMSE5)
cross_validation[2,4] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,4] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)

# ===================================== 6.Using mean by movie ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
RMSE1 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'RMSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAE')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'01')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
RMSE2 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'RMSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAE')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'01')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
RMSE3 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'RMSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAE')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'01')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
RMSE4 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'RMSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAE')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'01')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
RMSE5 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'RMSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAE')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'01')

cross_validation[1,5] = mean(RMSE1,RMSE2,RMSE3,RMSE4,RMSE5)
cross_validation[2,5] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,5] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)

rm(naive_prediction1,RMSE1,RMSE2,RMSE3,RMSE4,RMSE5,MAE1,MAE2,MAE3,MAE4,MAE5,EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)
