# = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
#       Fichier : Erreurs_prediction_naive.R
#       Description : 
# = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

# ===================================== 1.Création de la matrice de validation croisée ===============================================

cross_validation = matrix(0,3,5)
colnames(cross_validation) = c("random","meanOfUsers","meanOfMovies","meanByUser","meanByMovie")
rownames(cross_validation) = c("MSE","MAE","01")

# ===================================== 2.Using random ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
MSE1 = error_function(naive_prediction1$rating,naive_prediction1$random,'MSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAD')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$random,'0-1')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
MSE2 = error_function(naive_prediction1$rating,naive_prediction1$random,'MSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAD')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$random,'0-1')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
MSE3 = error_function(naive_prediction1$rating,naive_prediction1$random,'MSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAD')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$random,'0-1')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
MSE4 = error_function(naive_prediction1$rating,naive_prediction1$random,'MSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAD')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$random,'0-1')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
MSE5 = error_function(naive_prediction1$rating,naive_prediction1$random,'MSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$random,'MAD')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$random,'0-1')

cross_validation[1,1] = mean(MSE1,MSE2,MSE3,MSE4,MSE5)
cross_validation[2,1] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,1] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)

# ===================================== 3.Using MeanOfUsers ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
MSE1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAD')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'0-1')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
MSE2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAD')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'0-1')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
MSE3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAD')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'0-1')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
MSE4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAD')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'0-1')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
MSE5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'MAD')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfUsers,'0-1')

cross_validation[1,2] = mean(MSE1,MSE2,MSE3,MSE4,MSE5)
cross_validation[2,2] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,2] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)


# ===================================== 4.Using Mean of movies ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
MSE1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAD')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'0-1')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
MSE2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAD')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'0-1')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
MSE3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAD')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'0-1')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
MSE4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAD')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'0-1')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
MSE5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'MAD')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$meanOfMovies,'0-1')

cross_validation[1,3] = mean(MSE1,MSE2,MSE3,MSE4,MSE5)
cross_validation[2,3] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,3] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)

# ===================================== 5.Using mean by user ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
MSE1 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAD')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'0-1')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
MSE2 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAD')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'0-1')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
MSE3 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAD')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'0-1')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
MSE4 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAD')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'0-1')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
MSE5 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'MAD')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$meanByUser,'0-1')

cross_validation[1,4] = mean(MSE1,MSE2,MSE3,MSE4,MSE5)
cross_validation[2,4] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,4] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)

# ===================================== 6.Using mean by movie ===============================================
naive_prediction1 = naive_prediction(TrainingU1,TestU1)
MSE1 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MSE')
MAE1 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAD')
EBIN1 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'0-1')

naive_prediction1 = naive_prediction(TrainingU2,TestU2)
MSE2 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MSE')
MAE2 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAD')
EBIN2 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'0-1')

naive_prediction1 = naive_prediction(TrainingU3,TestU3)
MSE3 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MSE')
MAE3 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAD')
EBIN3 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'0-1')

naive_prediction1 = naive_prediction(TrainingU4,TestU4)
MSE4 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MSE')
MAE4 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAD')
EBIN4 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'0-1')

naive_prediction1 = naive_prediction(TrainingU5,TestU5)
MSE5 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MSE')
MAE5 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'MAD')
EBIN5 = error_function(naive_prediction1$rating,naive_prediction1$meanByMovie,'0-1')

cross_validation[1,5] = mean(MSE1,MSE2,MSE3,MSE4,MSE5)
cross_validation[2,5] = mean(MAE1,MAE2,MAE3,MAE4,MAE5)
cross_validation[3,5] = mean(EBIN1,EBIN2,EBIN3,EBIN4,EBIN5)

rm(naive_prediction1,MSE1,MSE2,MSE3,MSE4,MSE5)
