\documentclass[a4paper, 11pt]{book}
\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[francais]{babel}
\usepackage{amssymb,amsmath}
\allowdisplaybreaks
\usepackage{mathrsfs}
\usepackage{color}

\usepackage{graphicx}
%\usepackage{fancybox}
%\usepackage{cadre}
\newenvironment{bottompar}{\par\vspace*{\fill}}{\clearpage}

\usepackage[left=2.5cm,top=2.5cm,right=2.5cm,bottom=2.5cm,bindingoffset=0cm]{geometry}

\usepackage{fancyhdr}
\pagestyle{fancy}
\renewcommand{\footrulewidth}{0.5pt}
\fancyhead[R]{Groupe de statistique appliquée}
\fancyhead[L]{}
\fancyfoot[R]{ENSAE}
\fancyfoot[L]{2015-2016}

\newcommand{\thedate}{\today}
%\setlength\parindent{0em}
\usepackage{hyperref} %pour utiliser les hyperliens 

\begin{document}
\title{Sujet 2 - Collaborative filtering}
\author{
Etudiants : Biwei \textsc{Cui}, Claudia \textsc{Delgado}, Mehdi \textsc{Miah}, Ulrich \textsc{Mpeli Mpeli} \\
Tuteurs : Vincent \textsc{Cottet}, Mehdi  \textsc{Sebbar}
}

\date{\today}
\maketitle

\tableofcontents
\newpage

\paragraph{Rappel des notations utilisées}

\medskip

Pour un problème donné, nous avons les variables suivants : \\
\begin{itemize}
\item[$\bullet$]  $N_U$ le nombre d'utilisateurs ; 
\item[$\bullet$]  $N_M$ le nombre de films ;
\item[$\bullet$]  $N$ le nombre de notes
\end{itemize}

\medskip

\begin{itemize}
\item[$\bullet$] $U = (u_1, u_2, ..., u_{N_U})$ l'ensemble des utilisateurs  ;
\item[$\bullet$]  $M = (m_1, m_2, ..., m_{N_M})$ l'ensemble des films ;
\item[$\bullet$]  $Y = (y_{u,m})_{(u, m) \in U \times M}$ telle que : $ y_{u,m} = \text{note donnée par l'utilisateur } u \text{ pour le film } m$ ; 
\item[$\bullet$]  $R = r(u,m)_{(u, m) \in U \times M}$ telles que :
$r(u,m) = 
\left\{
\begin{array}{ll}
1 & \text{si l'utilisateur } u \text{ a noté le film } m \\
0  & \text{sinon} \
\end{array}
\right.$
\end{itemize}

\medskip

\begin{itemize}
\item[$\bullet$]  $\Omega_0 = \{(u,m) \in U \times M | r(u,m) = 0 \}$ ;
\item[$\bullet$]  $\Omega_1 = \{(u,m) \in U \times M | r(u,m) = 1\}$ ;
\item[$\bullet$]  $\forall u_0 \in U, \mathcal{M}(u_0) = \{m | r(u_0,m) = 1 \}$, l'ensemble des films qu'a vu l'utilisateur $u_0$ ;
\item[$\bullet$]  $\forall m_0 \in M, \mathcal{U}(m_0) = \{u | r(u,m_0) = 1 \}$, l'ensemble des utilisateurs qui ont vu le film $m_0$
\end{itemize}

\medskip

\begin{itemize}
\item[$\bullet$]  $\forall u_0 \in U, \overline{\mathcal{M}(u_0)} = M \setminus \mathcal{M}(u_0)$, l'ensemble des films que n'a pas vu l'utilisateur $u_0$
\end{itemize}

\chapter{Introduction}

\section{Contexte et justification}

En facilitant l'accès à l'information, l'avènement du numérique met en avant un autre problème : celui du choix. En effet, avec l'évolution de la quantité d'information disponible sur Internet, le nombre de choix qui nous sont ouverts augmente sans cesse. Livres, jeux, musiques, images et films sont autant d'éléments dans lesquels nous sommes amenés à opérer une sélection sans avoir ni le temps, ni la possibilité de considérer toutes les informations nécessaires. 

Pour résoudre ce problème, il est de plus en plus fréquent de proposer aux internautes d'attribuer une note à un article qui peut être un livre ou un film qu'ils ont vu ; et ces derniers attribuent de notes plus ou moins grande (sur une échelle de 1 à 10, ou 1 à 5), selon que l'article leur a plu ou pas. Ces notes constituent un ensemble d'information qui pourront orienter d'autres utilisateurs du web dans leurs décisions quotidiennes. A titre d'illustration, si un internaute a apprécié un article, il est fort probable qu'un autre internaute ayant des goûts similaires à ce dernier apprécie également ledit article. Il est donc possible de tirer profit des informations disponibles sur les choix de certains internautes pour induire des préférences sur les choix d'autres internautes. La formalisation et l'exploitation de cette intuition sont l'objet des travaux en filtrage collaboratif (Collaborative filtering) qui est un cas particulier de filtrage, qui a pour principe d'exploiter les évaluations que des utilisateurs ont faites de certains documents, afin de recommander ces mêmes documents à d'autres utilisateurs proches de lui, et sans qu'il soit nécessaire d'analyser le contenu des documents \cite{nguyen}.

Dans le cadre de cette étude, nous nous intéressons à la recommandation des films à pour des internautes grâce aux données issues de la plateforme MovieLens.
 
 \section{Position du problème}
 
 \section{Données disponibles}

Dans ce projet, nous utiliserons les bases issues du site web \url{http://grouplens.org/datasets/movielens/}. Ainsi, quatre bases de taille variable sont disponibles : \\
$\diamond$ ml-100k avec 100 000 notes attribuées par 943 utilisateurs à 1 682 films ; \\
$\diamond$ ml-1m avec 1 000 209 notes attribuées par 6 040 utilisateurs à 3 952 films ; \\
$\diamond$ ml-10m avec 10 000 054 notes attribuées par 71 567 utilisateurs à 10 681 films ; \\
$\diamond$ ml-20m avec 20 000 263 notes attribuées par 138 493 utilisateurs à 27 278 films. \\

Ces quatre problèmes disposent de fichiers contenant : \\
$\diamond$ les notes attribuées par les utilisateurs aux films, noté data.Ratings ; \\
$\diamond$ les descriptions des films, noté data.Movies ; \\
$\diamond$ les descriptions des utilisateurs, noté data.Users quand le fichier existe.

\section{Présentation de la base ml-100k}

Nous considérons les bases de données suivantes : data.Ratings, data.Movies et data.Users. \\

Nous noterons dans la suite : 
\begin{itemize}
\item[$\bullet$]  $N_U$ le nombre d'utilisateurs ; 
\item[$\bullet$]  $N_M$ le nombre de films ;
\item[$\bullet$]  $N$ le nombre de notes
\end{itemize}

Par exemple, pour la base ml-100k : $N_U = 943$, $N_M = 1682$ et $N = 100000$.

\subsection{La base des notes : data.Ratings}

Montrons tout d'abord les premiers éléments de cette base pour ml-100k : 

% Table created by stargazer v.5.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
% Date and time: sam., déc. 12, 2015 - 17:15:36
\begin{table}[h!] \centering 
  \caption{data.Ratings} 
  \label{} 
\begin{tabular}{@{\extracolsep{2pt}} ccccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & userID & movieID & rating & timestamp \\ 
\hline \\[-1.8ex] 
1 & $196$ & $242$ & $3$ & $881,250,949$ \\ 
2 & $186$ & $302$ & $3$ & $891,717,742$ \\ 
3 & $22$ & $377$ & $1$ & $878,887,116$ \\ 
4 & $244$ & $51$ & $2$ & $880,606,923$ \\ 
5 & $166$ & $346$ & $1$ & $886,397,596$ \\ 
6 & $298$ & $474$ & $4$ & $884,182,806$ \\ 
7 & $115$ & $265$ & $2$ & $881,171,488$ \\ 
8 & $253$ & $465$ & $5$ & $891,628,467$ \\ 
9 & $305$ & $451$ & $3$ & $886,324,817$ \\ 
10 & $6$ & $86$ & $3$ & $883,603,013$ \\ 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}

Dans notre projet, nous ne considérerons pas la variable timestramp. \\

\subsection{La base des films : data.Movies}

Montrons tout d'abord les premiers éléments de cette base pour ml-100k : 

% Table created by stargazer v.5.2 by Marek Hlavac, Harvard University, and modified by the author of this file
\begin{table}[h!] \centering 
  \caption{data.Movies} 
  \label{} 
\begin{tabular}{@{\extracolsep{2pt}} cccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & movieID & title & date \\ 
\hline \\[-1.8ex] 
1 & $1$ & Toy Story (1995) & 01-Jan-1995 \\ 
2 & $2$ & GoldenEye (1995) & 01-Jan-1995 \\ 
3 & $3$ & Four Rooms (1995) & 01-Jan-1995 \\ 
4 & $4$ & Get Shorty (1995) & 01-Jan-1995 \\ 
5 & $5$ & Copycat (1995) & 01-Jan-1995 \\ 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table}

Nous comptons également : \\
$\diamond$ la variable \texttt{IMDbURL} qui indique le lien url du film sur le site imdb.com ; \\
$\diamond$ 19 variables booléennes qui caractérisent le genre cinématographique : \texttt{unknown}, \texttt{action}, \texttt{adventure}, \texttt{animation}, \texttt{children's}, \texttt{comedy},
\texttt{crime}, \texttt{documentary}, \texttt{drama}, \texttt{fantasy}, \texttt{film-noir}, \texttt{horror}, \texttt{musical}, \texttt{mystery}, \texttt{romance}, \texttt{sci-fi}, \texttt{thriller}, \texttt{war}, \texttt{western}. \\
Ainsi, chaque film est caractérisé par 23 variables, dont 19 booléennes.

\subsection{La base des utilisateurs : data.Users}

Montrons tout d'abord les premiers éléments de cette base pour ml-100k : 

% Table created by stargazer v.5.2 by Marek Hlavac, Harvard University. E-mail: hlavac at fas.harvard.edu
% Date and time: sam., déc. 12, 2015 - 17:46:07
\begin{table}[h] \centering 
  \caption{data.Users} 
  \label{} 
\begin{tabular}{@{\extracolsep{5pt}} cccccc} 
\\[-1.8ex]\hline 
\hline \\[-1.8ex] 
 & userID & age & gender & occupation & zip.code \\ 
\hline \\[-1.8ex] 
1 & $1$ & $24$ & M & technician & 85711 \\ 
2 & $2$ & $53$ & F & other & 94043 \\ 
3 & $3$ & $23$ & M & writer & 32067 \\ 
4 & $4$ & $24$ & M & technician & 43537 \\ 
5 & $5$ & $33$ & F & other & 15213 \\ 
6 & $6$ & $42$ & M & executive & 98101 \\ 
7 & $7$ & $57$ & M & administrator & 91344 \\ 
8 & $8$ & $36$ & M & administrator & 05201 \\ 
9 & $9$ & $29$ & M & student & 01002 \\ 
10 & $10$ & $53$ & M & lawyer & 90703 \\ 
\hline \\[-1.8ex] 
\end{tabular} 
\end{table} 

\subsection{Notation pour la prédiction}

Soit $U = (u_1, u_2, ..., u_{N_U})$ le vecteur des utilisateurs et $M = (m_1, m_2, ..., m_{N_M})$ le vecteur des films. \\
Considérons la matrice $Y = (y_{u,m})_{(u, m) \in U \times M}$ telle que :\\
$$ y_{u,m} = \text{note donnée par l'utilisateur } u \text{ pour le film } m \, ( y_{u,m} \in [\![1,5]\!])$$

$Y$ est donc une matrice $N_U \times N_M$. A quoi ressemble une telle matrice ?\\
Pour le cas du probleme ml-100k, $Y$ est une matrice de taille $943 \times 1 682$ comprenant 1 586 126 éléments dont exactement 100 000 valeurs non nulles ; donc le taux de complétion est de 6.3\%. C'est donc une matrice creuse.
\bigskip

Tentons de déterminer la note que donnerait l'utilisateur $u$ à un film $m$ qu'il n'a pas vu. \\
Introduisons pour cela les variables booléennes $r(u,m)_{(u, m) \in U \times M}$ telles que :\\
$$r(u,m) = 
\left\{
\begin{array}{ll}
1 & \text{si l'utilisateur } u \text{ a noté le film } m \\
0  & \text{sinon} \
\end{array}
\right.$$
\medskip 

Ainsi $y_{u,m}$ n'a de sens que si $r(u,m) =1$. Donc, tentons de déterminer les éléments de $Y=(y_{u,m)}$ tels que $r(u,m)=0$. \\

Nous noterons les ensembles suivants : 
\begin{itemize}
\item[$\bullet$]  $\Omega_0 = \{(u,m) \in U \times M | r(u,m) = 0 \}$ ;
\item[$\bullet$]  $\Omega_1 = \{(u,m) \in U \times M | r(u,m) = 1\}$ ;
\item[$\bullet$]  $\forall u_0 \in U, \mathcal{M}(u_0) = \{m | r(u_0,m) = 1 \}$, l'ensemble des films qu'a vu l'utilisateur $u_0$ ;
\item[$\bullet$]  $\forall m_0 \in M, \mathcal{U}(m_0) = \{u | r(u,m_0) = 1 \}$, l'ensemble des utilisateurs qui ont vu le film $m_0$
\end{itemize}

\chapter{Approches méthodologiques}

\section{Quantification de l'erreur}

\subsection{L'erreur 0-1}

On considère que l'on a mal prédit une valeur dès que la prédiction est différente de la réalité.

\subsection{L'erreur RMSE}

\subsection{L'erreur MAD}

\chapter{Analyse descriptive}

\chapter{Prédiction}

\section{Algorithmes naïves}

Considérons $u \in U, m \in M$ tels que $(u,m) \in \Omega_0$.

\subsubsection{Aléatoire}

On affecte de manière aléatoire (suivant une distribution uniforme sur $[0,5]$) une note à un élément $y_{u,m}$ où $(u,m) \in \Omega_0$.

\subsubsection{Note unique : la moyenne de toutes les notes}

Cette seconde approche donne à tous les éléments la valeur : 
$$\hat{\overline{y}} \triangleq \displaystyle \dfrac{1}{N} \sum \limits_{(u,m) \in \Omega_1} y_{u,m}$$

\subsubsection{Note unique : la moyenne des moyennes des films}

Ici, ce sera une autre valeur qui sera attribuée à l'ensemble $\Omega_0$ : 
$$\hat{\overline{y_{|M}}}  \triangleq \displaystyle \dfrac{1}{N_M} \sum \limits_{m \in M} \overline{y_{|m}}$$
où  $\overline{y_{|m_0}} \triangleq \displaystyle \dfrac{1}{|\mathcal{U}(m_0)|} \sum \limits_{u \in \mathcal{U}(m_0) } y_{u,m_0}$ pour $m_0 \in M$.

\subsubsection{Note unique : la moyenne des moyennes par utilisateur}

Par analogie, on affecte ici la valeur : 
$$\hat{\overline{y_{|U}}}  \triangleq \displaystyle \dfrac{1}{N_U} \sum \limits_{u \in U} \overline{y_{|u}}$$
où  $\overline{y_{|u_0}} \triangleq \displaystyle \dfrac{1}{|\mathcal{M}(u_0)|} \sum \limits_{m \in \mathcal{M}(u_0) } y_{u_0,m}$ pour $u_0 \in U$.

\subsubsection{Prédiction par la moyenne des notes du film}

Soit $m_0 \in M$. On affecte dans ce cas la même note à l'ensemble $\{y_{u,m_0} \vert (u,m_0) \in \Omega_0 \}$ la valeur : 
$$\widehat{\overline{y_{(m_0)}}} \triangleq  \displaystyle \dfrac{1}{| \mathcal{U}(m_0) |} \sum \limits_{ u \in \mathcal{U}(m_0)} y_{u,m_0}$$
$\widehat{\overline{y_{(m_0)}}}$ représente la note moyenne donnée au film $m_0$ par les autres utilisateurs.
 
\subsubsection{Prédiction par la moyenne des notes de l'utilisateur}

De manière duale, soit $u_0 \in U$. On affecte ici la même note à l'ensemble $\{y_{u_0,m} \vert (u_0,m) \in \Omega_0 \}$ la valeur : 
$$\widehat{\overline{y_{(u_0)}}} \triangleq \displaystyle \dfrac{1}{\vert \mathcal{M}(u_0) \vert} \sum \limits_{m \in \mathcal{M}(u_0)} y_{u_0,m}$$
$\widehat{\overline{y_{(u_0)}}}$ représente la note moyenne donnée par l'utilisateur $u_0$.

\section{Résultats des algorithmes naïves}

\section{Méthode des plus proches voisins}

\subsection{Notion de similarité}

\subsubsection{La corrélation}

\subsubsection{La similarité de Jaccard}

\subsubsection{La similarité cosinus }




  \begin{thebibliography}{1}

  \bibitem{nguyen} An-Te Nguyen {\em COCoFil2 : Un nouveau système de filtrage collaboratif basé sur le modèle des espaces de communautés. Modélisation et simulation. } Université Joseph-Fourier - Grenoble I, 2006, p 1-5.

  \end{thebibliography}

\end{document}
